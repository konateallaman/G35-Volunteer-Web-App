<div class="container mt-4">
  <h2 class="mb-4 text-center"><strong>User Management</strong></h2>

  <!-- Add/Edit Users -->
  <form [formGroup]="addUserForm" (ngSubmit)="onAddUser()">
    <!-- Row with both email and skills -->
    <div class="row mb-3" style="background: initial; ">
      <!-- Email field (half width) -->
      <div class="col-sm-6" style="background: initial; ">
        <label for="email" class="col-form-label">Email:</label>
        <mat-form-field appearance="fill" class="w-100">
          <mat-label>Email</mat-label>
          <input matInput id="email" formControlName="email" placeholder="Enter email" required />
        </mat-form-field>
        <div *ngIf="addUserForm.controls['email'].invalid && addUserForm.controls['email'].touched" class="error-message" >
          Please enter a valid email address.
        </div>
      </div>

      <!-- Skills field (half width) -->
      <div class="col-sm-6" style="background: initial; ">
        <label for="skills" class="col-form-label">Skills:</label>
        <mat-form-field appearance="fill" class="w-100">
          <mat-label>Select Skills</mat-label>
          <mat-select formControlName="skills" multiple>
            <mat-option *ngFor="let skill of skillOptions" [value]="skill">{{ skill }}</mat-option>
          </mat-select>
        </mat-form-field>
        <div *ngIf="addUserForm.controls['skills'].invalid && addUserForm.controls['skills'].touched" class="error-message" >
          At least one skill is required.
        </div>
        
      </div>
    </div>

    <!-- Form action buttons -->

<div class="d-flex justify-content-center" style="background: initial;">
  

  <!-- Cancel Button with Cancel Icon -->
  <button type="button" class="btn btn-danger icon-button me-2" (click)="onCancel()">
    <mat-icon>cancel</mat-icon> <!-- Angular Material Cancel Icon -->
    Cancel
  </button>
  <!-- Add/Update Button with different icons -->
  <button type="submit" class="btn btn-primary icon-button me-2" [disabled]="addUserForm.invalid">
    <mat-icon>{{ isEditMode ? 'edit' : 'add_circle' }}</mat-icon> 
    {{ isEditMode ? 'Update User' : 'Add User' }}
  </button>
</div>

  </form>

  <!-- User search input -->
  <form>
    <div class="mb-3 row" style="background: initial; ">
      <label for="table-filtering-search" class="col-sm-auto col-form-label">User search:</label>
      <div class="col-sm-auto" style="all: initial; ">
        <input id="table-filtering-search" class="form-control" placeholder="search email" type="text" [formControl]="filter" />
      </div>
    </div>
  </form>

  <!-- No user found message -->
  <div *ngIf="filteredusers.length === 0" class="alert alert-danger" role="alert" style="width: 300px;" style="background: initial; ">
    No user found.
  </div>

  <!-- User table -->
  <div class="mt-1" style="background: initial; ">
    <!-- <h3 class="mb-3 text-center"><strong>All Users</strong></h3> -->
    <table class="table table-striped table-hover">
      <thead class="thead-dark">
        <tr>
          <th>#</th>
          <th>Email</th>
          <th>Skills</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of filteredusers | slice: (page - 1) * pageSize : page * pageSize; let i = index">
          <td>{{ (page - 1) * pageSize + i + 1 }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.skills.join(', ') }}</td>
          <td>
            <button class="btn btn-warning me-2 icon-button" (click)="onEdit(i)">
              <mat-icon>edit</mat-icon>
            </button>
            <button class="btn btn-danger icon-button" (click)="onDelete(i)">
              <mat-icon>delete_forever</mat-icon>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination -->
    <div class="d-flex justify-content-center" style="background: initial; ">
      <ngb-pagination 
        class="custom-pagination" 
        [collectionSize]="filteredusers.length" 
        [(page)]="page" 
        [pageSize]="pageSize" 
        [maxSize]="5" 
        [boundaryLinks]="true">
      </ngb-pagination>
    </div>
  </div>
</div>
